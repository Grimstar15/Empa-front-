{"ast":null,"code":"import _objectSpread from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import\"bootstrap\";import{Table,FormGroup,Form,Col,Row}from\"react-bootstrap\";import ReactNotification from\"react-notifications-component\";import{store}from\"react-notifications-component\";import\"./Admin.scss\";import axios from\"axios\";import{API_HOST,create_training,delete_training}from\"../../api_utils\";import{Link}from\"react-router-dom\";import Modal from\"../../components/Modal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Admin=function Admin(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState({category_id:null,title:null,price:null,training_language:null,capacity:null}),_useState4=_slicedToArray(_useState3,2),body=_useState4[0],setBody=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isValid=_useState8[0],setIsValid=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),pages=_useState10[0],setPages=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),error=_useState12[0],setError=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),category=_useState14[0],setCategory=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),modal=_useState16[0],setModal=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),modaldata=_useState18[0],setModaldata=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),validated=_useState20[0],setValidated=_useState20[1];var upload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(body){var newPage;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return create_training(body);case 2:newPage=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function upload(_x){return _ref.apply(this,arguments);};}();var handldeSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(name){_context2.next=3;break;}setIsValid(false);return _context2.abrupt(\"return\");case 3:console.log(body);// const newPage = await create_training(body);\n// body.forEach((item, index) => {\n//   upload(item);\n// });\n//  body.map((el) => upload(el));\n// const newPage = await create_page(body);\n//   setName(\"\");\n//  setPages([...pages, newPage]);\ncase 4:case\"end\":return _context2.stop();}}},_callee2);}));return function handldeSubmit(){return _ref2.apply(this,arguments);};}();var handle=function handle(e){var newbody=_objectSpread({},body);if(e.target.id===\"image\"){var _image=e.target.files[0];setImage(_image);console.log(\"kkk\",_image);}else{newbody[e.target.id]=e.target.value;setBody(newbody);}};var getimage=function getimage(e){var files=e.target.files;var data=new FormData();data.append(\"file\",files[0]);console.log(e.target.files);};var deleteTraining=function deleteTraining(e){if(window.confirm(\"\".concat(e[1],\" \\n\\u0423\\u0441\\u0442\\u0433\\u0430\\u0445\\u0434\\u0430\\u0430 \\u0438\\u0442\\u0433\\u044D\\u043B\\u0442\\u044D\\u0439 \\u0431\\u0430\\u0439\\u043D\\u0430 \\u0443\\u0443?\"))){delete_training(e[0]);var newPage=pages.filter(function(item){return item.id!==e[0];});setPages(newPage);}};var submit=function submit(e){var form=e.currentTarget;if(form.checkValidity()===false){e.preventDefault();e.stopPropagation();}var createTraining=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(body){var token,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:token={token:localStorage.getItem(\"token\")};_context3.prev=1;_context3.next=4;return axios.post(\"\".concat(API_HOST,\"/training\"),body).then(function(res){if(res.data===\"success\"){window.location.reload();}else console.log(\"error on response\");});case 4:response=_context3.sent;return _context3.abrupt(\"return\",response.data);case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);console.log(\"error :>>\",_context3.t0);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function createTraining(_x2){return _ref3.apply(this,arguments);};}();setValidated(true);if(form.checkValidity()===true){e.preventDefault();var data=new FormData();data.append(\"file\",image);data.append(\"category_id\",body.category_id);data.append(\"title\",body.title);data.append(\"price\",body.price);data.append(\"training_language\",body.training_language);data.append(\"capacity\",body.capacity);data.append(\"token\",localStorage.getItem(\"token\"));var res=createTraining(data);}};var alertMessage=function alertMessage(){store.addNotification({title:\"Амжилттай нэмлээ.\",message:\"Амжилттай нэмлээ.\",type:\"success\",container:\"top-right\",insert:\"top\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeout\"],dismiss:{duration:1000,showIcon:true},width:600});};useEffect(function(){function getAllPages(){return _getAllPages.apply(this,arguments);}function _getAllPages(){_getAllPages=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response,_category;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.get(\"\".concat(API_HOST,\"/training\"));case 3:response=_context4.sent;_context4.next=6;return axios.get(\"\".concat(API_HOST,\"/training_category\"));case 6:_category=_context4.sent;setPages(response.data);setCategory(_category.data);console.log(response.data);_context4.next=16;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](0);console.log(\"error :>>\",_context4.t0);setError(_context4.t0.message);case 16:case\"end\":return _context4.stop();}}},_callee4,null,[[0,12]]);}));return _getAllPages.apply(this,arguments);}getAllPages();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[modal&&/*#__PURE__*/_jsx(Modal,{closeModal:setModal,data:modaldata,category:category}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-header\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"modal-tittle\",id:\"addPageModalLabel\",Create:true,Page:true,children:\"Create page\"})}),/*#__PURE__*/_jsxs(Form,{noValidate:true,validated:validated,onSubmit:submit,children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Title\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"text\",placeholder:\"Title of Page\",onChange:function onChange(e){return handle(e);},id:\"title\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{children:\"Looks good!\"})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Category \\u0441\\u043E\\u043D\\u0433\\u043E\\u0445\"}),/*#__PURE__*/_jsxs(Form.Select,{onChange:function onChange(e){return handle(e);},id:\"category_id\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:0,children:\"\\u0421\\u043E\\u043D\\u0433\\u043E\\u0445\"}),/*#__PURE__*/_jsx(\"option\",{value:0,children:\"\\u0421\\u043E\\u043D\\u0433\\u043E\\u0445\"}),category?category.map(function(item){return/*#__PURE__*/_jsx(\"option\",{value:item.id,children:item.title});}):\"No category\"]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{children:\"Looks good!\"})]})]}),/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"number\",placeholder:\"Price\",onChange:function onChange(e){return handle(e);},id:\"price\"})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0425\\u044D\\u043B\"}),/*#__PURE__*/_jsxs(Form.Select,{onChange:function onChange(e){return handle(e);},required:true,id:\"training_language\",children:[/*#__PURE__*/_jsx(\"option\",{children:\"\\u0421\\u043E\\u043D\\u0433\\u043E\\u0445\"}),/*#__PURE__*/_jsx(\"option\",{children:\"\\u0410\\u043D\\u0433\\u043B\\u0438\"}),/*#__PURE__*/_jsx(\"option\",{children:\"\\u041C\\u043E\\u043D\\u0433\\u043E\\u043B\"})]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please provide a valid city.\"})]})]}),/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0425\\u04AF\\u043D\\u0438\\u0439 \\u0442\\u043E\\u043E\"}),/*#__PURE__*/_jsx(Form.Control,{onChange:function onChange(e){return handle(e);},id:\"capacity\",type:\"number\",required:true,placeholder:\"\\u0425\\u04AF\\u043D\\u0438\\u0439 \\u0442\\u043E\\u043E\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please provide a valid state.\"})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0417\\u0443\\u0440\\u0430\\u0433\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"file\",onChange:function onChange(e){return handle(e);},id:\"image\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"\\u0417\\u0443\\u0440\\u0430\\u0433 \\u043E\\u0440\\u0443\\u0443\\u043B\\u043D\\u0430 \\u0443\\u0443\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary btn-sm\",onClick:\"clearForm()\",children:\"Clear\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-sm\",children:\"Submit\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 my-2\",children:[error&&/*#__PURE__*/_jsx(\"div\",{role:\"alert\",className:\"alert alert-primary\",children:error}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:pages?pages.map(function(page){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:page.id}),/*#__PURE__*/_jsx(\"td\",{children:page.title}),/*#__PURE__*/_jsx(\"td\",{children:page.price}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:{pathname:\"/editor/\".concat(page.id),state:{page:page}},children:\"Edit\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"transparent\"},onClick:function onClick(){return deleteTraining([page.id,page.title]);},children:\"Delete\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"transparent\"},onClick:function onClick(){setModal(true);setModaldata(page);},children:\"Details\"})})]},page.id);}):\"No page\"})]})]})]});};export default Admin;","map":{"version":3,"sources":["/home/empawebadmin/empaweb/frontend/src/containers/Admin/index.js"],"names":["React","useState","useEffect","Table","FormGroup","Form","Col","Row","ReactNotification","store","axios","API_HOST","create_training","delete_training","Link","Modal","Admin","name","setName","category_id","title","price","training_language","capacity","body","setBody","image","setImage","isValid","setIsValid","pages","setPages","error","setError","category","setCategory","modal","setModal","modaldata","setModaldata","validated","setValidated","upload","newPage","handldeSubmit","console","log","handle","e","newbody","target","id","files","value","getimage","data","FormData","append","deleteTraining","window","confirm","filter","item","submit","form","currentTarget","checkValidity","preventDefault","stopPropagation","createTraining","token","localStorage","getItem","post","then","res","location","reload","response","alertMessage","addNotification","message","type","container","insert","animationIn","animationOut","dismiss","duration","showIcon","width","getAllPages","get","map","page","pathname","state","background"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"bootstrap\";\r\nimport { Table, FormGroup, Form, Col, Row } from \"react-bootstrap\";\r\nimport ReactNotification from \"react-notifications-component\";\r\nimport { store } from \"react-notifications-component\";\r\nimport \"./Admin.scss\";\r\nimport axios from \"axios\";\r\nimport { API_HOST, create_training, delete_training } from \"../../api_utils\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Modal from \"../../components/Modal\";\r\n\r\nconst Admin = () => {\r\n  const [name, setName] = useState(\"\");\r\n  const [body, setBody] = useState({\r\n    category_id: null,\r\n    title: null,\r\n    price: null,\r\n    training_language: null,\r\n    capacity: null,\r\n  });\r\n  const [image, setImage] = useState();\r\n  const [isValid, setIsValid] = useState(true);\r\n  const [pages, setPages] = useState([]);\r\n  const [error, setError] = useState(\"\");\r\n  const [category, setCategory] = useState([]);\r\n  const [modal, setModal] = useState(false);\r\n  const [modaldata, setModaldata] = useState([]);\r\n  const [validated, setValidated] = useState(false);\r\n  const upload = async (body) => {\r\n    const newPage = await create_training(body);\r\n  };\r\n  const handldeSubmit = async () => {\r\n    if (!name) {\r\n      setIsValid(false);\r\n      return;\r\n    }\r\n    console.log(body);\r\n    // const newPage = await create_training(body);\r\n    // body.forEach((item, index) => {\r\n    //   upload(item);\r\n    // });\r\n    //  body.map((el) => upload(el));\r\n    // const newPage = await create_page(body);\r\n    //   setName(\"\");\r\n    //  setPages([...pages, newPage]);\r\n  };\r\n\r\n  const handle = (e) => {\r\n    const newbody = { ...body };\r\n\r\n    if (e.target.id === \"image\") {\r\n      const image = e.target.files[0];\r\n\r\n      setImage(image);\r\n      console.log(\"kkk\", image);\r\n    } else {\r\n      newbody[e.target.id] = e.target.value;\r\n      setBody(newbody);\r\n    }\r\n  };\r\n  const getimage = (e) => {\r\n    const files = e.target.files;\r\n    const data = new FormData();\r\n    data.append(\"file\", files[0]);\r\n    console.log(e.target.files);\r\n  };\r\n  const deleteTraining = (e) => {\r\n    if (window.confirm(`${e[1]} \\nУстгахдаа итгэлтэй байна уу?`)) {\r\n      delete_training(e[0]);\r\n      const newPage = pages.filter((item) => item.id !== e[0]);\r\n      setPages(newPage);\r\n    }\r\n  };\r\n  const submit = (e) => {\r\n    const form = e.currentTarget;\r\n    if (form.checkValidity() === false) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n    const createTraining = async (body) => {\r\n      const token = { token: localStorage.getItem(\"token\") };\r\n      try {\r\n        const response = await axios\r\n          .post(`${API_HOST}/training`, body)\r\n          .then((res) => {\r\n            if (res.data === \"success\") {\r\n              window.location.reload();\r\n            } else console.log(\"error on response\");\r\n          });\r\n        return response.data;\r\n      } catch (error) {\r\n        console.log(\"error :>>\", error);\r\n      }\r\n    };\r\n    setValidated(true);\r\n\r\n    if (form.checkValidity() === true) {\r\n      e.preventDefault();\r\n\r\n      const data = new FormData();\r\n      data.append(\"file\", image);\r\n      data.append(\"category_id\", body.category_id);\r\n      data.append(\"title\", body.title);\r\n      data.append(\"price\", body.price);\r\n      data.append(\"training_language\", body.training_language);\r\n      data.append(\"capacity\", body.capacity);\r\n      data.append(\"token\", localStorage.getItem(\"token\"));\r\n\r\n      const res = createTraining(data);\r\n    }\r\n  };\r\n\r\n  const alertMessage = () => {\r\n    store.addNotification({\r\n      title: \"Амжилттай нэмлээ.\",\r\n      message: \"Амжилттай нэмлээ.\",\r\n      type: \"success\",\r\n      container: \"top-right\",\r\n      insert: \"top\",\r\n      animationIn: [\"animated\", \"fadeIn\"],\r\n      animationOut: [\"animated\", \"fadeout\"],\r\n\r\n      dismiss: {\r\n        duration: 1000,\r\n        showIcon: true,\r\n      },\r\n      width: 600,\r\n    });\r\n  };\r\n  useEffect(() => {\r\n    async function getAllPages() {\r\n      try {\r\n        const response = await axios.get(`${API_HOST}/training`);\r\n        const category = await axios.get(`${API_HOST}/training_category`);\r\n        setPages(response.data);\r\n        setCategory(category.data);\r\n        console.log(response.data);\r\n      } catch (error) {\r\n        console.log(\"error :>>\", error);\r\n        setError(error.message);\r\n      }\r\n    }\r\n    getAllPages();\r\n  }, []);\r\n  return (\r\n    <div className=\"container\">\r\n      {modal && (\r\n        <Modal closeModal={setModal} data={modaldata} category={category} />\r\n      )}\r\n      <div className=\"col-12 mt-5\">\r\n        <div className=\"modal-header\">\r\n          <h5 className=\"modal-tittle\" id=\"addPageModalLabel\" Create Page>\r\n            Create page\r\n          </h5>\r\n        </div>\r\n        <Form noValidate validated={validated} onSubmit={submit}>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Title</Form.Label>\r\n              <Form.Control\r\n                required\r\n                type=\"text\"\r\n                placeholder=\"Title of Page\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"title\"\r\n              />\r\n              <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\r\n            </Form.Group>\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Category сонгох</Form.Label>\r\n              <Form.Select\r\n                onChange={(e) => handle(e)}\r\n                id=\"category_id\"\r\n                required\r\n              >\r\n                <option value={0}>Сонгох</option>\r\n                <option value={0}>Сонгох</option>\r\n                {category\r\n                  ? category.map((item) => (\r\n                      <option value={item.id}>{item.title}</option>\r\n                    ))\r\n                  : \"No category\"}\r\n              </Form.Select>\r\n              <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Price</Form.Label>\r\n              <Form.Control\r\n                required\r\n                type=\"number\"\r\n                placeholder=\"Price\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"price\"\r\n              />\r\n            </Form.Group>\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Хэл</Form.Label>\r\n              <Form.Select\r\n                onChange={(e) => handle(e)}\r\n                required\r\n                id=\"training_language\"\r\n              >\r\n                <option>Сонгох</option>\r\n                <option>Англи</option>\r\n                <option>Монгол</option>\r\n              </Form.Select>\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Please provide a valid city.\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Хүний тоо</Form.Label>\r\n              <Form.Control\r\n                onChange={(e) => handle(e)}\r\n                id=\"capacity\"\r\n                type=\"number\"\r\n                required\r\n                placeholder=\"Хүний тоо\"\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Please provide a valid state.\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Зураг</Form.Label>\r\n              <Form.Control\r\n                required\r\n                type=\"file\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"image\"\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Зураг оруулна уу\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n\r\n          <div className=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn btn-secondary btn-sm\"\r\n              onClick=\"clearForm()\"\r\n            >\r\n              Clear\r\n            </button>\r\n            <button type=\"submit\" className=\"btn btn-primary btn-sm\">\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </Form>\r\n      </div>\r\n\r\n      <div className=\"col-12 my-2\">\r\n        {error && (\r\n          <div role=\"alert\" className=\"alert alert-primary\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        <Table striped bordered hover>\r\n          <thead>\r\n            <tr>\r\n              <td>ID</td>\r\n              <td>Name</td>\r\n              <td>Price</td>\r\n              <td colSpan=\"3\">Action</td>\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody>\r\n            {pages\r\n              ? pages.map((page) => (\r\n                  <tr key={page.id}>\r\n                    <td>{page.id}</td>\r\n                    <td>{page.title}</td>\r\n                    <td>{page.price}</td>\r\n                    <td>\r\n                      <Link\r\n                        to={{ pathname: `/editor/${page.id}`, state: { page } }}\r\n                      >\r\n                        Edit\r\n                      </Link>\r\n                    </td>\r\n                    <td>\r\n                      <button\r\n                        style={{ background: \"transparent\" }}\r\n                        onClick={() => deleteTraining([page.id, page.title])}\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </td>\r\n                    <td>\r\n                      <button\r\n                        style={{ background: \"transparent\" }}\r\n                        onClick={() => {\r\n                          setModal(true);\r\n                          setModaldata(page);\r\n                        }}\r\n                      >\r\n                        Details\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              : \"No page\"}\r\n          </tbody>\r\n        </Table>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Admin;\r\n"]},"metadata":{},"sourceType":"module"}
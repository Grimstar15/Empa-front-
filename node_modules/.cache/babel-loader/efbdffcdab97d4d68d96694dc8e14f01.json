{"ast":null,"code":"import _regeneratorRuntime from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import\"bootstrap\";import{Table,FormGroup,Form,Col,Row}from\"react-bootstrap\";import style from\"./NewsEdit.scss\";import{Link}from\"react-router-dom\";import NewsModal from\"../../components/NewsModal\";import{API_HOST,banner_upload,delete_Banner,delete_news,news_upload}from\"../../api_utils\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NewsEdit=function NewsEdit(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isValid=_useState4[0],setIsValid=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),news=_useState6[0],setNews=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),modal=_useState10[0],setModal=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),category=_useState12[0],setCategory=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),body=_useState14[0],setBody=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),modaldata=_useState16[0],setModaldata=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),validated=_useState18[0],setValidated=_useState18[1];var date=new Date();var handle=function handle(e){var newbody=_objectSpread({},body);if(e.target.id===\"image\"){var _image=e.target.files[0];setImage(_image);console.log(\"kkk\",_image);}else{newbody[e.target.id]=e.target.value;setBody(newbody);}};var deleteNews=function deleteNews(e){if(window.confirm(\"\".concat(e[1],\" \\n\\u0423\\u0441\\u0442\\u0433\\u0430\\u0445\\u0434\\u0430\\u0430 \\u0438\\u0442\\u0433\\u044D\\u043B\\u0442\\u044D\\u0439 \\u0431\\u0430\\u0439\\u043D\\u0430 \\u0443\\u0443?\"))){delete_news(e[0]);var newNews=news.filter(function(item){return item.id!==e[0];});setNews(newNews);}};var newsUpload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(body){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"\".concat(API_HOST,\"/news\"),body).then(function(res){if(res.data===\"success\"){window.location.reload();}else console.log(\"error on response\");});case 3:response=_context.sent;_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.log(\"error :>>\",_context.t0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function newsUpload(_x){return _ref.apply(this,arguments);};}();var submit=function submit(e){var form=e.currentTarget;if(form.checkValidity()===false){e.preventDefault();e.stopPropagation();}setValidated(true);if(form.checkValidity()===true){e.preventDefault();var data=new FormData();console.log(body);data.append(\"file\",image);data.append(\"brief\",body.brief);data.append(\"date\",body.date);data.append(\"title\",body.title);data.append(\"type\",body.type);newsUpload(data);}};useEffect(function(){function getAllPages(){return _getAllPages.apply(this,arguments);}function _getAllPages(){_getAllPages=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"\".concat(API_HOST,\"/news\"));case 3:response=_context2.sent;setNews(response.data);console.log(response.data);_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.log(\"error :>>\",_context2.t0);setError(_context2.t0.message);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return _getAllPages.apply(this,arguments);}getAllPages();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[modal&&/*#__PURE__*/_jsx(NewsModal,{closeModal:setModal,data:modaldata}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-header\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"modal-tittle\",id:\"addPageModalLabel\",Create:true,Page:true,children:\"\\u041C\\u044D\\u0434\\u044D\\u044D \\u043D\\u044D\\u043C\\u044D\\u0445\"})}),/*#__PURE__*/_jsxs(Form,{noValidate:true,validated:validated,onSubmit:submit,children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0413\\u0430\\u0440\\u0447\\u0438\\u0433\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"text\",placeholder:\"\\u041C\\u044D\\u0434\\u044D\\u044D\\u043D\\u0438\\u0439 \\u0433\\u0430\\u0440\\u0447\\u0438\\u0433\",onChange:function onChange(e){return handle(e);},id:\"title\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"\\u041C\\u044D\\u0434\\u044D\\u044D\\u043D\\u0438\\u0439 \\u0433\\u0430\\u0440\\u0447\\u0438\\u0433 \\u043E\\u0440\\u0443\\u0443\\u043B\\u043D\\u0430 \\u0443\\u0443!\"})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0422\\u04E9\\u0440\\u04E9\\u043B \\u0441\\u043E\\u043D\\u0433\\u043E\\u0445\"}),/*#__PURE__*/_jsxs(Form.Select,{onChange:function onChange(e){return handle(e);},id:\"type\",required:true,\"aria-label\":\"\\u0421\\u043E\\u043D\\u0433\\u043E\\u0445\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Хувь хүний хөгжил\",children:\"\\u0421\\u043E\\u043D\\u0433\\u043E\\u0445\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Хувь хүний хөгжил\",children:\"\\u0425\\u0443\\u0432\\u044C \\u0445\\u04AF\\u043D\\u0438\\u0439 \\u0445\\u04E9\\u0433\\u0436\\u0438\\u043B\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Сургалт\",children:\"\\u0421\\u0443\\u0440\\u0433\\u0430\\u043B\\u0442\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Ярилцлага\",children:\"\\u042F\\u0440\\u0438\\u043B\\u0446\\u043B\\u0430\\u0433\\u0430\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Бүтээгдэхүүн\",children:\"\\u0411\\u04AF\\u0442\\u044D\\u044D\\u0433\\u0434\\u044D\\u0445\\u04AF\\u04AF\\u043D\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Арга хэмжээ\",children:\"\\u0410\\u0440\\u0433\\u0430 \\u0445\\u044D\\u043C\\u0436\\u044D\\u044D\"})]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"\\u0422\\u04E9\\u0440\\u04E9\\u043B\\u04E9\\u04E9 \\u0441\\u043E\\u043D\\u0433\\u043E\\u043D\\u043E \\u0443\\u0443\"})]})]}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"12\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0422\\u043E\\u0432\\u0447 \\u0442\\u0430\\u0439\\u043B\\u0431\\u0430\\u0440\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"text\",placeholder:\"\\u0422\\u043E\\u0432\\u0447 \\u0442\\u0430\\u0439\\u043B\\u0431\\u0430\\u0440\",onChange:function onChange(e){return handle(e);},id:\"brief\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"\\u0422\\u043E\\u0432\\u0447 \\u0442\\u0430\\u0439\\u043B\\u0431\\u0430\\u0440 \\u043E\\u0440\\u0443\\u0443\\u043B\\u043D\\u0430 \\u0443\\u0443!\"})]})}),/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u041E\\u043D \\u0441\\u0430\\u0440\"}),/*#__PURE__*/_jsx(Form.Control,{onChange:function onChange(e){return handle(e);},id:\"date\",type:\"date\",required:true}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"\\u041E\\u043D \\u0441\\u0430\\u0440\\u0430\\u0430 \\u043E\\u0440\\u0443\\u0443\\u043B\\u043D\\u0430 \\u0443\\u0443!\"})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0417\\u0443\\u0440\\u0430\\u0433\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"file\",onChange:function onChange(e){return handle(e);},id:\"image\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"\\u0417\\u0443\\u0440\\u0430\\u0433 \\u043E\\u0440\\u0443\\u0443\\u043B\\u043D\\u0430 \\u0443\\u0443\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary btn-sm\",onClick:\"clearForm()\",children:\"Clear\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-sm\",children:\"Submit\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 my-2\",children:[error&&/*#__PURE__*/_jsx(\"div\",{role:\"alert\",className:\"alert alert-primary\",children:error}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"\\u0413\\u0430\\u0440\\u0447\\u0438\\u0433\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\u0422\\u04E9\\u0440\\u04E9\\u043B\"}),/*#__PURE__*/_jsx(\"td\",{children:\"\\u041E\\u0433\\u043D\\u043E\\u043E\"}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"3\",children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:news?news.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.title}),/*#__PURE__*/_jsx(\"td\",{children:item.type}),/*#__PURE__*/_jsx(\"td\",{children:item.date}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:{pathname:\"/newsEdit/\".concat(item.id),state:{item:item}},children:\"Edit\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"transparent\"},onClick:function onClick(){return deleteNews([item.id,item.title]);},children:\"Delete\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"transparent\"},onClick:function onClick(){setModal(true);setModaldata(item);},children:\"Details\"})})]},item.id);}):\"No news\"})]})]})]});};export default NewsEdit;","map":{"version":3,"sources":["/home/empawebadmin/empaweb/frontend/src/components/NewsEdit/index.js"],"names":["React","useState","useEffect","Table","FormGroup","Form","Col","Row","style","Link","NewsModal","API_HOST","banner_upload","delete_Banner","delete_news","news_upload","axios","NewsEdit","image","setImage","isValid","setIsValid","news","setNews","error","setError","modal","setModal","category","setCategory","body","setBody","modaldata","setModaldata","validated","setValidated","date","Date","handle","e","newbody","target","id","files","console","log","value","deleteNews","window","confirm","newNews","filter","item","newsUpload","post","then","res","data","location","reload","response","submit","form","currentTarget","checkValidity","preventDefault","stopPropagation","FormData","append","brief","title","type","getAllPages","get","message","map","pathname","state","background"],"mappings":"omBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAO,WAAP,CACA,OAASC,KAAT,CAAgBC,SAAhB,CAA2BC,IAA3B,CAAiCC,GAAjC,CAAsCC,GAAtC,KAAiD,iBAAjD,CACA,MAAOC,CAAAA,KAAP,KAAkB,iBAAlB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAOC,CAAAA,SAAP,KAAsB,4BAAtB,CACA,OACEC,QADF,CAEEC,aAFF,CAGEC,aAHF,CAIEC,WAJF,CAKEC,WALF,KAMO,iBANP,CAOA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,wFAEA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACrB,cAA0BhB,QAAQ,EAAlC,wCAAOiB,KAAP,eAAcC,QAAd,eACA,eAA8BlB,QAAQ,CAAC,IAAD,CAAtC,yCAAOmB,OAAP,eAAgBC,UAAhB,eACA,eAAwBpB,QAAQ,CAAC,EAAD,CAAhC,yCAAOqB,IAAP,eAAaC,OAAb,eACA,eAA0BtB,QAAQ,CAAC,EAAD,CAAlC,yCAAOuB,KAAP,eAAcC,QAAd,eACA,eAA0BxB,QAAQ,CAAC,KAAD,CAAlC,0CAAOyB,KAAP,gBAAcC,QAAd,gBACA,gBAAgC1B,QAAQ,CAAC,EAAD,CAAxC,2CAAO2B,QAAP,gBAAiBC,WAAjB,gBACA,gBAAwB5B,QAAQ,CAAC,KAAD,CAAhC,2CAAO6B,IAAP,gBAAaC,OAAb,gBACA,gBAAkC9B,QAAQ,CAAC,EAAD,CAA1C,2CAAO+B,SAAP,gBAAkBC,YAAlB,gBACA,gBAAkChC,QAAQ,CAAC,KAAD,CAA1C,2CAAOiC,SAAP,gBAAkBC,YAAlB,gBACA,GAAMC,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,EAAb,CACA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACC,CAAD,CAAO,CACpB,GAAMC,CAAAA,OAAO,kBAAQV,IAAR,CAAb,CAEA,GAAIS,CAAC,CAACE,MAAF,CAASC,EAAT,GAAgB,OAApB,CAA6B,CAC3B,GAAMxB,CAAAA,MAAK,CAAGqB,CAAC,CAACE,MAAF,CAASE,KAAT,CAAe,CAAf,CAAd,CAEAxB,QAAQ,CAACD,MAAD,CAAR,CACA0B,OAAO,CAACC,GAAR,CAAY,KAAZ,CAAmB3B,MAAnB,EACD,CALD,IAKO,CACLsB,OAAO,CAACD,CAAC,CAACE,MAAF,CAASC,EAAV,CAAP,CAAuBH,CAAC,CAACE,MAAF,CAASK,KAAhC,CACAf,OAAO,CAACS,OAAD,CAAP,CACD,CACF,CAZD,CAaA,GAAMO,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACR,CAAD,CAAO,CACxB,GAAIS,MAAM,CAACC,OAAP,WAAkBV,CAAC,CAAC,CAAD,CAAnB,4JAAJ,CAA8D,CAC5DzB,WAAW,CAACyB,CAAC,CAAC,CAAD,CAAF,CAAX,CACA,GAAMW,CAAAA,OAAO,CAAG5B,IAAI,CAAC6B,MAAL,CAAY,SAACC,IAAD,QAAUA,CAAAA,IAAI,CAACV,EAAL,GAAYH,CAAC,CAAC,CAAD,CAAvB,EAAZ,CAAhB,CACAhB,OAAO,CAAC2B,OAAD,CAAP,CACD,CACF,CAND,CAOA,GAAMG,CAAAA,UAAU,0FAAG,iBAAOvB,IAAP,qKAEQd,CAAAA,KAAK,CACzBsC,IADoB,WACZ3C,QADY,UACKmB,IADL,EAEpByB,IAFoB,CAEf,SAACC,GAAD,CAAS,CACb,GAAIA,GAAG,CAACC,IAAJ,GAAa,SAAjB,CAA4B,CAC1BT,MAAM,CAACU,QAAP,CAAgBC,MAAhB,GACD,CAFD,IAEOf,CAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EACR,CANoB,CAFR,QAETe,QAFS,6FAUfhB,OAAO,CAACC,GAAR,CAAY,WAAZ,cAVe,mEAAH,kBAAVQ,CAAAA,UAAU,4CAAhB,CAaA,GAAMQ,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,CAACtB,CAAD,CAAO,CACpB,GAAMuB,CAAAA,IAAI,CAAGvB,CAAC,CAACwB,aAAf,CACA,GAAID,IAAI,CAACE,aAAL,KAAyB,KAA7B,CAAoC,CAClCzB,CAAC,CAAC0B,cAAF,GACA1B,CAAC,CAAC2B,eAAF,GACD,CAED/B,YAAY,CAAC,IAAD,CAAZ,CAEA,GAAI2B,IAAI,CAACE,aAAL,KAAyB,IAA7B,CAAmC,CACjCzB,CAAC,CAAC0B,cAAF,GACA,GAAMR,CAAAA,IAAI,CAAG,GAAIU,CAAAA,QAAJ,EAAb,CACAvB,OAAO,CAACC,GAAR,CAAYf,IAAZ,EACA2B,IAAI,CAACW,MAAL,CAAY,MAAZ,CAAoBlD,KAApB,EACAuC,IAAI,CAACW,MAAL,CAAY,OAAZ,CAAqBtC,IAAI,CAACuC,KAA1B,EACAZ,IAAI,CAACW,MAAL,CAAY,MAAZ,CAAoBtC,IAAI,CAACM,IAAzB,EACAqB,IAAI,CAACW,MAAL,CAAY,OAAZ,CAAqBtC,IAAI,CAACwC,KAA1B,EACAb,IAAI,CAACW,MAAL,CAAY,MAAZ,CAAoBtC,IAAI,CAACyC,IAAzB,EACAlB,UAAU,CAACI,IAAD,CAAV,CACD,CACF,CApBD,CAsBAvD,SAAS,CAAC,UAAM,SACCsE,CAAAA,WADD,2IACd,6LAE2BxD,CAAAA,KAAK,CAACyD,GAAN,WAAa9D,QAAb,UAF3B,QAEUiD,QAFV,gBAGIrC,OAAO,CAACqC,QAAQ,CAACH,IAAV,CAAP,CACAb,OAAO,CAACC,GAAR,CAAYe,QAAQ,CAACH,IAArB,EAJJ,mFAMIb,OAAO,CAACC,GAAR,CAAY,WAAZ,eACApB,QAAQ,CAAC,aAAMiD,OAAP,CAAR,CAPJ,sEADc,8CAWdF,WAAW,GACZ,CAZQ,CAYN,EAZM,CAAT,CAaA,mBACE,aAAK,SAAS,CAAC,WAAf,WACG9C,KAAK,eAAI,KAAC,SAAD,EAAW,UAAU,CAAEC,QAAvB,CAAiC,IAAI,CAAEK,SAAvC,EADZ,cAEE,aAAK,SAAS,CAAC,aAAf,wBACE,YAAK,SAAS,CAAC,cAAf,uBACE,WAAI,SAAS,CAAC,cAAd,CAA6B,EAAE,CAAC,mBAAhC,CAAoD,MAAM,KAA1D,CAA2D,IAAI,KAA/D,2EADF,EADF,cAME,MAAC,IAAD,EAAM,UAAU,KAAhB,CAAiB,SAAS,CAAEE,SAA5B,CAAuC,QAAQ,CAAE2B,MAAjD,wBACE,MAAC,GAAD,EAAK,SAAS,CAAC,MAAf,wBACE,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEvD,GAAhB,CAAqB,EAAE,CAAC,GAAxB,wBACE,KAAC,IAAD,CAAM,KAAN,mDADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,MAFP,CAGE,WAAW,CAAC,uFAHd,CAIE,QAAQ,CAAE,kBAACiC,CAAD,QAAOD,CAAAA,MAAM,CAACC,CAAD,CAAb,EAJZ,CAKE,EAAE,CAAC,OALL,EAFF,cASE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,4JATF,GADF,cAcE,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEjC,GAAhB,CAAqB,EAAE,CAAC,GAAxB,wBACE,KAAC,IAAD,CAAM,KAAN,kFADF,cAEE,MAAC,IAAD,CAAM,MAAN,EACE,QAAQ,CAAE,kBAACiC,CAAD,QAAOD,CAAAA,MAAM,CAACC,CAAD,CAAb,EADZ,CAEE,EAAE,CAAC,MAFL,CAGE,QAAQ,KAHV,CAIE,aAAW,sCAJb,wBAME,eAAQ,KAAK,CAAE,mBAAf,kDANF,cAOE,eAAQ,KAAK,CAAE,mBAAf,0GAPF,cAQE,eAAQ,KAAK,CAAE,SAAf,wDARF,cASE,eAAQ,KAAK,CAAE,WAAf,oEATF,cAUE,eAAQ,KAAK,CAAE,cAAf,sFAVF,cAWE,eAAQ,KAAK,CAAE,aAAf,2EAXF,GAFF,cAeE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,gHAfF,GAdF,GADF,cAmCE,KAAC,GAAD,EAAK,SAAS,CAAC,MAAf,uBACE,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEjC,GAAhB,CAAqB,EAAE,CAAC,IAAxB,wBACE,KAAC,IAAD,CAAM,KAAN,kFADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,MAFP,CAGE,WAAW,CAAC,qEAHd,CAIE,QAAQ,CAAE,kBAACiC,CAAD,QAAOD,CAAAA,MAAM,CAACC,CAAD,CAAb,EAJZ,CAKE,EAAE,CAAC,OALL,EAFF,cASE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,0IATF,GADF,EAnCF,cAkDE,MAAC,GAAD,EAAK,SAAS,CAAC,MAAf,wBACE,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEjC,GAAhB,CAAqB,EAAE,CAAC,GAAxB,wBACE,KAAC,IAAD,CAAM,KAAN,8CADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,CAAE,kBAACiC,CAAD,QAAOD,CAAAA,MAAM,CAACC,CAAD,CAAb,EADZ,CAEE,EAAE,CAAC,MAFL,CAGE,IAAI,CAAC,MAHP,CAIE,QAAQ,KAJV,EAFF,cAQE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,kHARF,GADF,cAaE,MAAC,IAAD,CAAM,KAAN,EAAY,EAAE,CAAEjC,GAAhB,CAAqB,EAAE,CAAC,GAAxB,wBACE,KAAC,IAAD,CAAM,KAAN,6CADF,cAEE,KAAC,IAAD,CAAM,OAAN,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,MAFP,CAGE,QAAQ,CAAE,kBAACiC,CAAD,QAAOD,CAAAA,MAAM,CAACC,CAAD,CAAb,EAHZ,CAIE,EAAE,CAAC,OAJL,EAFF,cAQE,KAAC,IAAD,CAAM,OAAN,CAAc,QAAd,EAAuB,IAAI,CAAC,SAA5B,oGARF,GAbF,GAlDF,cA6EE,aAAK,SAAS,CAAC,cAAf,wBACE,eACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,0BAFZ,CAGE,OAAO,CAAC,aAHV,mBADF,cAQE,eAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,wBAAhC,oBARF,GA7EF,GANF,GAFF,cAmGE,aAAK,SAAS,CAAC,aAAf,WACGf,KAAK,eACJ,YAAK,IAAI,CAAC,OAAV,CAAkB,SAAS,CAAC,qBAA5B,UACGA,KADH,EAFJ,cAME,MAAC,KAAD,EAAO,OAAO,KAAd,CAAe,QAAQ,KAAvB,CAAwB,KAAK,KAA7B,wBACE,oCACE,mCACE,4DADF,cAEE,sDAFF,cAGE,sDAHF,cAIE,WAAI,OAAO,CAAC,GAAZ,oBAJF,GADF,EADF,cAUE,uBACGF,IAAI,CACDA,IAAI,CAACqD,GAAL,CAAS,SAACvB,IAAD,qBACP,mCACE,oBAAKA,IAAI,CAACkB,KAAV,EADF,cAEE,oBAAKlB,IAAI,CAACmB,IAAV,EAFF,cAGE,oBAAKnB,IAAI,CAAChB,IAAV,EAHF,cAIE,iCACE,KAAC,IAAD,EACE,EAAE,CAAE,CACFwC,QAAQ,qBAAexB,IAAI,CAACV,EAApB,CADN,CAEFmC,KAAK,CAAE,CAAEzB,IAAI,CAAJA,IAAF,CAFL,CADN,kBADF,EAJF,cAcE,iCACE,eACE,KAAK,CAAE,CAAE0B,UAAU,CAAE,aAAd,CADT,CAEE,OAAO,CAAE,yBAAM/B,CAAAA,UAAU,CAAC,CAACK,IAAI,CAACV,EAAN,CAAUU,IAAI,CAACkB,KAAf,CAAD,CAAhB,EAFX,oBADF,EAdF,cAsBE,iCACE,eACE,KAAK,CAAE,CAAEQ,UAAU,CAAE,aAAd,CADT,CAEE,OAAO,CAAE,kBAAM,CACbnD,QAAQ,CAAC,IAAD,CAAR,CACAM,YAAY,CAACmB,IAAD,CAAZ,CACD,CALH,qBADF,EAtBF,GAASA,IAAI,CAACV,EAAd,CADO,EAAT,CADC,CAqCD,SAtCN,EAVF,GANF,GAnGF,GADF,CAgKD,CA/OD,CAiPA,cAAezB,CAAAA,QAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"bootstrap\";\r\nimport { Table, FormGroup, Form, Col, Row } from \"react-bootstrap\";\r\nimport style from \"./NewsEdit.scss\";\r\nimport { Link } from \"react-router-dom\";\r\nimport NewsModal from \"../../components/NewsModal\";\r\nimport {\r\n  API_HOST,\r\n  banner_upload,\r\n  delete_Banner,\r\n  delete_news,\r\n  news_upload,\r\n} from \"../../api_utils\";\r\nimport axios from \"axios\";\r\n\r\nconst NewsEdit = () => {\r\n  const [image, setImage] = useState();\r\n  const [isValid, setIsValid] = useState(true);\r\n  const [news, setNews] = useState([]);\r\n  const [error, setError] = useState(\"\");\r\n  const [modal, setModal] = useState(false);\r\n  const [category, setCategory] = useState([]);\r\n  const [body, setBody] = useState(false);\r\n  const [modaldata, setModaldata] = useState([]);\r\n  const [validated, setValidated] = useState(false);\r\n  const date = new Date();\r\n  const handle = (e) => {\r\n    const newbody = { ...body };\r\n\r\n    if (e.target.id === \"image\") {\r\n      const image = e.target.files[0];\r\n\r\n      setImage(image);\r\n      console.log(\"kkk\", image);\r\n    } else {\r\n      newbody[e.target.id] = e.target.value;\r\n      setBody(newbody);\r\n    }\r\n  };\r\n  const deleteNews = (e) => {\r\n    if (window.confirm(`${e[1]} \\nУстгахдаа итгэлтэй байна уу?`)) {\r\n      delete_news(e[0]);\r\n      const newNews = news.filter((item) => item.id !== e[0]);\r\n      setNews(newNews);\r\n    }\r\n  };\r\n  const newsUpload = async (body) => {\r\n    try {\r\n      const response = await axios\r\n        .post(`${API_HOST}/news`, body)\r\n        .then((res) => {\r\n          if (res.data === \"success\") {\r\n            window.location.reload();\r\n          } else console.log(\"error on response\");\r\n        });\r\n    } catch (error) {\r\n      console.log(\"error :>>\", error);\r\n    }\r\n  };\r\n  const submit = (e) => {\r\n    const form = e.currentTarget;\r\n    if (form.checkValidity() === false) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n\r\n    setValidated(true);\r\n\r\n    if (form.checkValidity() === true) {\r\n      e.preventDefault();\r\n      const data = new FormData();\r\n      console.log(body);\r\n      data.append(\"file\", image);\r\n      data.append(\"brief\", body.brief);\r\n      data.append(\"date\", body.date);\r\n      data.append(\"title\", body.title);\r\n      data.append(\"type\", body.type);\r\n      newsUpload(data);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    async function getAllPages() {\r\n      try {\r\n        const response = await axios.get(`${API_HOST}/news`);\r\n        setNews(response.data);\r\n        console.log(response.data);\r\n      } catch (error) {\r\n        console.log(\"error :>>\", error);\r\n        setError(error.message);\r\n      }\r\n    }\r\n    getAllPages();\r\n  }, []);\r\n  return (\r\n    <div className=\"container\">\r\n      {modal && <NewsModal closeModal={setModal} data={modaldata} />}\r\n      <div className=\"col-12 mt-5\">\r\n        <div className=\"modal-header\">\r\n          <h5 className=\"modal-tittle\" id=\"addPageModalLabel\" Create Page>\r\n            Мэдээ нэмэх\r\n          </h5>\r\n        </div>\r\n        <Form noValidate validated={validated} onSubmit={submit}>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Гарчиг</Form.Label>\r\n              <Form.Control\r\n                required\r\n                type=\"text\"\r\n                placeholder=\"Мэдээний гарчиг\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"title\"\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Мэдээний гарчиг оруулна уу!\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Төрөл сонгох</Form.Label>\r\n              <Form.Select\r\n                onChange={(e) => handle(e)}\r\n                id=\"type\"\r\n                required\r\n                aria-label=\"Сонгох\"\r\n              >\r\n                <option value={\"Хувь хүний хөгжил\"}>Сонгох</option>\r\n                <option value={\"Хувь хүний хөгжил\"}>Хувь хүний хөгжил</option>\r\n                <option value={\"Сургалт\"}>Сургалт</option>\r\n                <option value={\"Ярилцлага\"}>Ярилцлага</option>\r\n                <option value={\"Бүтээгдэхүүн\"}>Бүтээгдэхүүн</option>\r\n                <option value={\"Арга хэмжээ\"}>Арга хэмжээ</option>\r\n              </Form.Select>\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Төрөлөө сонгоно уу\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"12\">\r\n              <Form.Label>Товч тайлбар</Form.Label>\r\n              <Form.Control\r\n                required\r\n                type=\"text\"\r\n                placeholder=\"Товч тайлбар\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"brief\"\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Товч тайлбар оруулна уу!\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Он сар</Form.Label>\r\n              <Form.Control\r\n                onChange={(e) => handle(e)}\r\n                id=\"date\"\r\n                type=\"date\"\r\n                required\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Он сараа оруулна уу!\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Зураг</Form.Label>\r\n              <Form.Control\r\n                required\r\n                type=\"file\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"image\"\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Зураг оруулна уу\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n\r\n          <div className=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn btn-secondary btn-sm\"\r\n              onClick=\"clearForm()\"\r\n            >\r\n              Clear\r\n            </button>\r\n            <button type=\"submit\" className=\"btn btn-primary btn-sm\">\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </Form>\r\n      </div>\r\n      <div className=\"col-12 my-2\">\r\n        {error && (\r\n          <div role=\"alert\" className=\"alert alert-primary\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        <Table striped bordered hover>\r\n          <thead>\r\n            <tr>\r\n              <td>Гарчиг</td>\r\n              <td>Төрөл</td>\r\n              <td>Огноо</td>\r\n              <td colSpan=\"3\">Action</td>\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody>\r\n            {news\r\n              ? news.map((item) => (\r\n                  <tr key={item.id}>\r\n                    <td>{item.title}</td>\r\n                    <td>{item.type}</td>\r\n                    <td>{item.date}</td>\r\n                    <td>\r\n                      <Link\r\n                        to={{\r\n                          pathname: `/newsEdit/${item.id}`,\r\n                          state: { item },\r\n                        }}\r\n                      >\r\n                        Edit\r\n                      </Link>\r\n                    </td>\r\n                    <td>\r\n                      <button\r\n                        style={{ background: \"transparent\" }}\r\n                        onClick={() => deleteNews([item.id, item.title])}\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </td>\r\n                    <td>\r\n                      <button\r\n                        style={{ background: \"transparent\" }}\r\n                        onClick={() => {\r\n                          setModal(true);\r\n                          setModaldata(item);\r\n                        }}\r\n                      >\r\n                        Details\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              : \"No news\"}\r\n          </tbody>\r\n        </Table>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NewsEdit;\r\n"]},"metadata":{},"sourceType":"module"}
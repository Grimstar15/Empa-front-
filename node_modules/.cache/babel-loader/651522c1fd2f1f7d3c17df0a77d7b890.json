{"ast":null,"code":"import _regeneratorRuntime from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/empawebadmin/empaweb/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import\"bootstrap\";import{Table,FormGroup,Form,Col,Row}from\"react-bootstrap\";import style from\"./homeEdit.scss\";import{Link}from\"react-router-dom\";import{Modal}from\"bootstrap\";import{API_HOST,banner_upload,delete_Banner}from\"../../api_utils\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HomeEdit=function HomeEdit(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isValid=_useState4[0],setIsValid=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),banner=_useState6[0],setBanner=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),category=_useState10[0],setCategory=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),body=_useState12[0],setBody=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),modaldata=_useState14[0],setModaldata=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),validated=_useState16[0],setValidated=_useState16[1];var handle=function handle(e){var newbody=_objectSpread({},body);if(e.target.id===\"image\"){var _image=e.target.files[0];setImage(_image);console.log(\"kkk\",_image);}else{newbody[e.target.id]=e.target.value;setBody(newbody);}};var deleteBanner=function deleteBanner(e){if(window.confirm(\"\".concat(e[1],\" \\n\\u0423\\u0441\\u0442\\u0433\\u0430\\u0445\\u0434\\u0430\\u0430 \\u0438\\u0442\\u0433\\u044D\\u043B\\u0442\\u044D\\u0439 \\u0431\\u0430\\u0439\\u043D\\u0430 \\u0443\\u0443?\"))){delete_Banner(e[0]);var newBanner=banner.filter(function(item){return item.id!==e[0];});setBanner(newBanner);}};var submit=function submit(e){var form=e.currentTarget;if(form.checkValidity()===false){e.preventDefault();e.stopPropagation();}var banner_upload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(body){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"\".concat(API_HOST,\"/banner\"),body).then(function(res){if(res.data===\"success\"){window.location.reload();}else console.log(\"error on response\");});case 3:response=_context.sent;_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.log(\"error :>>\",_context.t0);case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return function banner_upload(_x){return _ref.apply(this,arguments);};}();setValidated(true);if(form.checkValidity()===true){e.preventDefault();var data=new FormData();console.log(body);data.append(\"file\",image);data.append(\"body\",body.body);data.append(\"link\",body.link);data.append(\"title\",body.title);data.append(\"page\",body.page);data.append(\"token\",localStorage.getItem(\"token\"));banner_upload(data);}};useEffect(function(){function getAllPages(){return _getAllPages.apply(this,arguments);}function _getAllPages(){_getAllPages=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"\".concat(API_HOST,\"/banner\"));case 3:response=_context2.sent;setBanner(response.data);console.log(response.data);_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.log(\"error :>>\",_context2.t0);setError(_context2.t0.message);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return _getAllPages.apply(this,arguments);}getAllPages();},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 mt-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-header\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"modal-tittle\",id:\"addPageModalLabel\",Create:true,Page:true,children:\"\\u0411\\u0430\\u043D\\u043D\\u044D\\u0440\"})}),/*#__PURE__*/_jsxs(Form,{noValidate:true,validated:validated,onSubmit:submit,children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Title\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"\\u0413\\u0430\\u0440\\u0447\\u0438\\u0433\",onChange:function onChange(e){return handle(e);},id:\"title\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{children:\"Looks good!\"})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0425\\u0443\\u0443\\u0434\\u0430\\u0441\"}),/*#__PURE__*/_jsxs(Form.Select,{onChange:function onChange(e){return handle(e);},id:\"page\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:0,children:\"\\u0421\\u043E\\u043D\\u0433\\u043E\\u0445\"}),/*#__PURE__*/_jsx(\"option\",{value:\"home\",children:\"\\u041D\\u04AF\\u04AF\\u0440\"}),/*#__PURE__*/_jsx(\"option\",{value:\"training\",children:\"\\u0421\\u0443\\u0440\\u0433\\u0430\\u043B\\u0442\"})]}),/*#__PURE__*/_jsx(Form.Control.Feedback,{children:\"Looks good!\"})]})]}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"12\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Body\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Text\",onChange:function onChange(e){return handle(e);},id:\"body\"})]})}),/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Link\"}),/*#__PURE__*/_jsx(Form.Control,{onChange:function onChange(e){return handle(e);},id:\"link\",type:\"text\",placeholder:\"Banner \\u043B\\u0438\\u043D\\u043A\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"Please provide a valid state.\"})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,md:\"6\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"\\u0417\\u0443\\u0440\\u0430\\u0433\"}),/*#__PURE__*/_jsx(Form.Control,{required:true,type:\"file\",onChange:function onChange(e){return handle(e);},id:\"image\"}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:\"\\u0417\\u0443\\u0440\\u0430\\u0433 \\u043E\\u0440\\u0443\\u0443\\u043B\\u043D\\u0430 \\u0443\\u0443\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary btn-sm\",onClick:\"clearForm()\",children:\"Clear\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary btn-sm\",children:\"Submit\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 my-2\",children:[error&&/*#__PURE__*/_jsx(\"div\",{role:\"alert\",className:\"alert alert-primary\",children:error}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Page\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Body\"}),/*#__PURE__*/_jsx(\"td\",{children:\"image\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:banner?banner.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.page}),/*#__PURE__*/_jsx(\"td\",{children:item.title}),/*#__PURE__*/_jsx(\"td\",{children:item.body}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:{pathname:item.imgurl},target:\"_blank\",children:\"link\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"transparent\"},onClick:function onClick(){return deleteBanner([item.id,item.title]);},children:\"Delete\"})})]},item.id);}):\"No page\"})]})]})]});};export default HomeEdit;","map":{"version":3,"sources":["/home/empawebadmin/empaweb/frontend/src/components/HomeEdit/index.js"],"names":["React","useState","useEffect","Table","FormGroup","Form","Col","Row","style","Link","Modal","API_HOST","banner_upload","delete_Banner","axios","HomeEdit","image","setImage","isValid","setIsValid","banner","setBanner","error","setError","category","setCategory","body","setBody","modaldata","setModaldata","validated","setValidated","handle","e","newbody","target","id","files","console","log","value","deleteBanner","window","confirm","newBanner","filter","item","submit","form","currentTarget","checkValidity","preventDefault","stopPropagation","post","then","res","data","location","reload","response","FormData","append","link","title","page","localStorage","getItem","getAllPages","get","message","map","pathname","imgurl","background"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"bootstrap\";\r\nimport { Table, FormGroup, Form, Col, Row } from \"react-bootstrap\";\r\nimport style from \"./homeEdit.scss\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Modal } from \"bootstrap\";\r\nimport { API_HOST, banner_upload, delete_Banner } from \"../../api_utils\";\r\nimport axios from \"axios\";\r\n\r\nconst HomeEdit = () => {\r\n  const [image, setImage] = useState();\r\n  const [isValid, setIsValid] = useState(true);\r\n  const [banner, setBanner] = useState([]);\r\n  const [error, setError] = useState(\"\");\r\n  const [category, setCategory] = useState([]);\r\n  const [body, setBody] = useState(false);\r\n  const [modaldata, setModaldata] = useState([]);\r\n  const [validated, setValidated] = useState(false);\r\n  const handle = (e) => {\r\n    const newbody = { ...body };\r\n\r\n    if (e.target.id === \"image\") {\r\n      const image = e.target.files[0];\r\n\r\n      setImage(image);\r\n      console.log(\"kkk\", image);\r\n    } else {\r\n      newbody[e.target.id] = e.target.value;\r\n      setBody(newbody);\r\n    }\r\n  };\r\n  const deleteBanner = (e) => {\r\n    if (window.confirm(`${e[1]} \\nУстгахдаа итгэлтэй байна уу?`)) {\r\n      delete_Banner(e[0]);\r\n      const newBanner = banner.filter((item) => item.id !== e[0]);\r\n      setBanner(newBanner);\r\n    }\r\n  };\r\n  const submit = (e) => {\r\n    const form = e.currentTarget;\r\n    if (form.checkValidity() === false) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n    const banner_upload = async (body) => {\r\n      try {\r\n        const response = await axios\r\n          .post(`${API_HOST}/banner`, body)\r\n          .then((res) => {\r\n            if (res.data === \"success\") {\r\n              window.location.reload();\r\n            } else console.log(\"error on response\");\r\n          });\r\n      } catch (error) {\r\n        console.log(\"error :>>\", error);\r\n      }\r\n    };\r\n\r\n    setValidated(true);\r\n\r\n    if (form.checkValidity() === true) {\r\n      e.preventDefault();\r\n      const data = new FormData();\r\n      console.log(body);\r\n      data.append(\"file\", image);\r\n      data.append(\"body\", body.body);\r\n      data.append(\"link\", body.link);\r\n      data.append(\"title\", body.title);\r\n      data.append(\"page\", body.page);\r\n      data.append(\"token\", localStorage.getItem(\"token\"));\r\n      banner_upload(data);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    async function getAllPages() {\r\n      try {\r\n        const response = await axios.get(`${API_HOST}/banner`);\r\n        setBanner(response.data);\r\n        console.log(response.data);\r\n      } catch (error) {\r\n        console.log(\"error :>>\", error);\r\n        setError(error.message);\r\n      }\r\n    }\r\n    getAllPages();\r\n  }, []);\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"col-12 mt-5\">\r\n        <div className=\"modal-header\">\r\n          <h5 className=\"modal-tittle\" id=\"addPageModalLabel\" Create Page>\r\n            Баннэр\r\n          </h5>\r\n        </div>\r\n        <Form noValidate validated={validated} onSubmit={submit}>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Title</Form.Label>\r\n              <Form.Control\r\n                type=\"text\"\r\n                placeholder=\"Гарчиг\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"title\"\r\n              />\r\n              <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\r\n            </Form.Group>\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Хуудас</Form.Label>\r\n              <Form.Select onChange={(e) => handle(e)} id=\"page\" required>\r\n                <option value={0}>Сонгох</option>\r\n                <option value={\"home\"}>Нүүр</option>\r\n                <option value={\"training\"}>Сургалт</option>\r\n              </Form.Select>\r\n              <Form.Control.Feedback>Looks good!</Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"12\">\r\n              <Form.Label>Body</Form.Label>\r\n              <Form.Control\r\n                type=\"text\"\r\n                placeholder=\"Text\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"body\"\r\n              />\r\n            </Form.Group>\r\n          </Row>\r\n          <Row className=\"mb-3\">\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Link</Form.Label>\r\n              <Form.Control\r\n                onChange={(e) => handle(e)}\r\n                id=\"link\"\r\n                type=\"text\"\r\n                placeholder=\"Banner линк\"\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Please provide a valid state.\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n            <Form.Group as={Col} md=\"6\">\r\n              <Form.Label>Зураг</Form.Label>\r\n              <Form.Control\r\n                required\r\n                type=\"file\"\r\n                onChange={(e) => handle(e)}\r\n                id=\"image\"\r\n              />\r\n              <Form.Control.Feedback type=\"invalid\">\r\n                Зураг оруулна уу\r\n              </Form.Control.Feedback>\r\n            </Form.Group>\r\n          </Row>\r\n\r\n          <div className=\"modal-footer\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn btn-secondary btn-sm\"\r\n              onClick=\"clearForm()\"\r\n            >\r\n              Clear\r\n            </button>\r\n            <button type=\"submit\" className=\"btn btn-primary btn-sm\">\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </Form>\r\n      </div>\r\n      <div className=\"col-12 my-2\">\r\n        {error && (\r\n          <div role=\"alert\" className=\"alert alert-primary\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        <Table striped bordered hover>\r\n          <thead>\r\n            <tr>\r\n              <td>Page</td>\r\n              <td>Name</td>\r\n              <td>Body</td>\r\n              <td>image</td>\r\n              <td>Action</td>\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody>\r\n            {banner\r\n              ? banner.map((item) => (\r\n                  <tr key={item.id}>\r\n                    <td>{item.page}</td>\r\n                    <td>{item.title}</td>\r\n                    <td>{item.body}</td>\r\n                    <td>\r\n                      <Link to={{ pathname: item.imgurl }} target=\"_blank\">\r\n                        link\r\n                      </Link>\r\n                    </td>\r\n\r\n                    <td>\r\n                      <button\r\n                        style={{ background: \"transparent\" }}\r\n                        onClick={() => deleteBanner([item.id, item.title])}\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              : \"No page\"}\r\n          </tbody>\r\n        </Table>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HomeEdit;\r\n"]},"metadata":{},"sourceType":"module"}